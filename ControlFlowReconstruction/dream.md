# No More Gotos:Decompilation Using Pattern-Independent Control-Flow Structuring and Semantics-Preserving Transformations

## Summary

This paper presents DREAM, a novel decompiler that offers a goto-free output, which is a significant advancement in the field of decompilation and malware analysis. DREAM employs a unique pattern-independent control-flow structuring algorithm that can recover all control constructs in binary programs and produce structured decompiled code without any goto statement. It also introduces semantics-preserving transformations that can transform unstructured control flow graphs into structured graphs.

The authors demonstrate the correctness of their algorithms and show that DREAM outperforms both the leading industry and academic decompilers: Hex-Rays and Phoenix. They use the GNU coreutils suite of utilities as a benchmark for their tests. The paper also discusses the application of DREAM in understanding and taking down botnets and other types of malware.

The methodology involves a series of steps including creating an Abstract Syntax Tree (AST) for single-entry and single-successor CFG regions, transforming cyclic regions into semantically equivalent single-entry single-successor regions, and applying several optimization steps to enhance readability.

The results of the experiments show that DREAM generated more compact code overall than Phoenix and Hex-Rays. When considering all unique functions, DREAMâ€™s decompiled output consists of fewer lines of code in comparison to Phoenix output and Hex-Rays output. The new version of the source code passed all coreutils tests, demonstrating that DREAM correctly recovered control-flow structures. The paper also presents a comparison of DREAM's performance with Hex-Rays in decompiling and analyzing real-world malware samples, where DREAM produced goto-free and compact code compared to Hex-Rays.

In conclusion, the paper suggests that DREAM represents a significant step forward for decompilation and malware analysis, producing more compact and understandable code. Future work will further examine the quality of the code produced by DREAM, particularly concerning its compactness.


## Ealuation

The evaluation of the DREAM decompiler in this paper is based on several quantitative metrics:
- Correctness: This measures the functional equivalence between the decompiled output and the input code. Two functions are considered semantically equivalent if they follow the same execution paths for the same inputs.
- Structuredness: This metric is used to measure the quality of the control-flow recovery in the decompiled code. It is inversely proportional to the number of goto statements in the decompiled output. The fewer the goto statements, the better the structuredness.
- Compactness: This is measured in two ways. First, the total lines of code generated by each decompiler are counted. This gives a global picture of the compactness of the decompiled output. Second, the authors count for how many functions each decompiler generated the fewest lines of code compared to the others. If multiple decompilers generate the same (minimal) number of lines of code, that is counted towards the total of each of them.

![SVypVVQND6](https://github.com/IAPCP/Decompiler-SoK/assets/11942934/b492688c-ff3e-4118-ab93-509eab07a580)
